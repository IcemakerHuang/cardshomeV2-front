import{p as $,av as A,d as F,f as I,g as R,h as D,t as E,aw as M,j,l as N,L as U,o as z,ax as O,u as X,c as t,ae as Y,ay as G,a3 as H,a4 as J,ad as K,x as Q,A as W,a5 as Z,ag as ee,a7 as s,az as te,Y as ae,ac as se,V as oe,ah as m,ap as V,a8 as d,a9 as le,aa as ne,X as B,ab as C,at as re,au as ie}from"./index-78fd00a0.js";import{c as ue,e as ce,u as de,d as me}from"./index.esm-d640a4e5.js";import{a as pe,V as i}from"./VCol-bfcc8725.js";import{V as k}from"./VRow-7a194c40.js";import{V as S}from"./VDivider-211c1553.js";import{V as ve}from"./VForm-bedf4e9d.js";const ge={actions:"button@2",article:"heading, paragraph",avatar:"avatar",button:"button",card:"image, heading","card-avatar":"image, list-item-avatar",chip:"chip","date-picker":"list-item, heading, divider, date-picker-options, date-picker-days, actions","date-picker-options":"text, avatar@2","date-picker-days":"avatar@28",divider:"divider",heading:"heading",image:"image","list-item":"text","list-item-avatar":"avatar, text","list-item-two-line":"sentences","list-item-avatar-two-line":"avatar, sentences","list-item-three-line":"paragraph","list-item-avatar-three-line":"avatar, paragraph",ossein:"ossein",paragraph:"text@3",sentences:"text@2",subtitle:"text",table:"table-heading, table-thead, table-tbody, table-tfoot","table-heading":"chip, text","table-thead":"heading@6","table-tbody":"table-row-divider@6","table-row-divider":"table-row, divider","table-row":"text@6","table-tfoot":"text@2, avatar@2",text:"text"};function fe(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t("div",{class:["v-skeleton-loader__bone",`v-skeleton-loader__${e}`]},[n])}function P(e){const[n,a]=e.split("@");return Array.from({length:a}).map(()=>_(n))}function _(e){let n=[];if(!e)return n;const a=ge[e];if(e!==a){if(e.includes(","))return L(e);if(e.includes("@"))return P(e);a.includes(",")?n=L(a):a.includes("@")?n=P(a):a&&n.push(_(a))}return[fe(e,n)]}function L(e){return e.replace(/\s/g,"").split(",").map(_)}const he=$({boilerplate:Boolean,color:String,loading:Boolean,loadingText:{type:String,default:"$vuetify.loading"},type:{type:[String,Array],default:"ossein"},...A(),...F(),...I()},"VSkeletonLoader"),_e=R()({name:"VSkeletonLoader",props:he(),setup(e,n){let{slots:a}=n;const{backgroundColorClasses:b,backgroundColorStyles:y}=D(E(e,"color")),{dimensionStyles:p}=M(e),{elevationClasses:f}=j(e),{themeClasses:o}=N(e),{t:x}=U(),h=z(()=>_(O(e.type).join(",")));return X(()=>{var c;const v=!a.default||e.loading;return t("div",{class:["v-skeleton-loader",{"v-skeleton-loader--boilerplate":e.boilerplate},o.value,b.value,f.value],style:[y.value,v?p.value:{}],"aria-busy":e.boilerplate?void 0:v,"aria-live":e.boilerplate?void 0:"polite","aria-label":e.boilerplate?void 0:x(e.loadingText),role:e.boilerplate?void 0:"alert"},[v?h.value:(c=a.default)==null?void 0:c.call(a)])}),{}}});const w=e=>(re("data-v-7ac36895"),e=e(),ie(),e),be=w(()=>m("h1",null,"請選取認同卡數量:",-1)),ye=w(()=>m("p",{class:"text-caption"},"備註：0元為免費申辦的認同卡，請選擇數量後，點選加入申辦清單。",-1)),xe={style:{"white-space":"pre"}},Ve=w(()=>m("h1",{class:"text-red text-h1"},"已下架",-1)),ke={__name:"ProductView",setup(e){const n=G(),a=H(),{api:b,apiAuth:y}=se(),p=J(),f=K(),o=Q({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""}),x=ue({quantity:ce().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:h,handleSubmit:v}=de({validationSchema:x,initialValues:{quantity:1}}),c=me("quantity"),q=v(async g=>{var r,l;if(!f.isLogin){a.push("/login");return}try{const{data:u}=await y.patch("/users/cart",{product:o.value._id,quantity:g.quantity});f.cart=u.result,p({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(u){const T=((l=(r=u==null?void 0:u.response)==null?void 0:r.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";p({text:T,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return W(async()=>{var g,r;try{const{data:l}=await b.get("/products/"+n.params.id);o.value._id=l.result._id,o.value.name=l.result.name,o.value.price=l.result.price,o.value.description=l.result.description,o.value.image=l.result.image,o.value.sell=l.result.sell,o.value.category=l.result.category,document.title=`卡底家 | ${o.value.name}`}catch(l){const u=((r=(g=l==null?void 0:l.response)==null?void 0:g.data)==null?void 0:r.message)||"發生錯誤，請稍後再試";p({text:u,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}}),a.push("/")}}),(g,r)=>(Z(),ee(ae,null,[t(pe,{class:"custom-font"},{default:s(()=>[t(k,null,{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[be]),_:1})]),_:1}),t(k,null,{default:s(()=>[t(i,{cols:"12",md:"6"},{default:s(()=>[t(_e,{class:"mx-auto border rounded-lg",elevation:24,type:"image"},{default:s(()=>[t(oe,{src:o.value.image},null,8,["src"])]),_:1})]),_:1}),t(S,{vertical:""}),t(i,{cols:"12",md:"6"},{default:s(()=>[t(i,{cols:"12"},{default:s(()=>[m("h1",null,V(o.value.name),1),m("h3",null,"預計申辦費用: $"+V(o.value.price),1),ye]),_:1}),t(S,{color:"success",inset:""}),t(i,{class:"pa-6",cols:"12"},{default:s(()=>[m("p",xe,V(o.value.description),1)]),_:1}),t(S,{color:"success",inset:""}),t(i,{cols:"12"},{default:s(()=>[t(ve,{disabled:d(h),onSubmit:le(d(q),["prevent"])},{default:s(()=>[t(k,null,{default:s(()=>[t(i,{cols:"6"},{default:s(()=>[t(ne,{type:"number",min:"0",modelValue:d(c).value.value,"onUpdate:modelValue":r[0]||(r[0]=l=>d(c).value.value=l),modelModifiers:{number:!0},"error-messages":d(c).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),t(i,{cols:"6"},{default:s(()=>[t(B,{type:"submit","prepend-icon":"mdi-cards",loading:d(h)},{default:s(()=>[C("加入申辦清單")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1}),t(te,{class:"align-center justify-center text-center","model-value":!o.value.sell,persistent:""},{default:s(()=>[Ve,t(B,{to:"/",color:"green"},{default:s(()=>[C("回首頁")]),_:1})]),_:1},8,["model-value"])],64))}},qe=Y(ke,[["__scopeId","data-v-7ac36895"]]);export{qe as default};
