import{ae as L,ad as X,x as _,o as Y,a4 as G,af as J,a5 as g,ag as V,c as a,a7 as l,ak as K,Y as w,ac as O,al as I,ah as T,V as Q,a8 as o,X as h,ab as n,aj as D,a9 as W,aq as Z,ap as x,am as k,aa as C,an as ee,ai as ae,T as le,av as te,aw as oe}from"./index-4baf4630.js";import{c as se,a as S,u as ne,d as F}from"./index.esm-350b9f4a.js";import{a as ue,V as u}from"./VCol-a0a165e7.js";import{V as j}from"./VRow-30cc76ff.js";import{V as re}from"./VForm-273a6607.js";const de=r=>(te("data-v-3ad70bab"),r=r(),oe(),r),ie=de(()=>T("h1",{class:"text-center"},"個人資料",-1)),ce={class:"rounded-xl elevation-14"},me={__name:"HomeView",setup(r){const s=X(),d=_(!1),q=[{icon:"mdi-account",text:"個人帳號："},{icon:"mdi-email",text:"電子信箱："},{icon:"mdi-cellphone",text:"我的手機："}],H=Y(()=>[{value:s.account},{value:s.email},{value:s.phone}]),{apiAuth:R}=O(),B=G(),A=_(null),E=()=>{i.value.value=s.account,c.value.value=s.email,m.value.value=s.phone,d.value=!0},M=()=>{d.value=!1,z(),A.value.deleteFileRecord()},N=se({account:S().required("帳號為必填"),email:S().email("信箱格式不正確").required("信箱為必填"),phone:S().required("手機為必填")}),{handleSubmit:P,isSubmitting:b,resetForm:z}=ne({validationSchema:N}),i=F("account"),c=F("email"),m=F("phone"),p=_([]),U=_([]),$=P(async y=>{var t,f;try{const e=new FormData;for(const v in y)e.append(v,y[v]);p.value.length>0&&e.append("image",p.value[0].file),console.log(e),await R.patch("/users/"+s._id,e),B({text:"編輯成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),s.getProfile(),M()}catch(e){console.log(e);const v=((f=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:f.message)||"發生錯誤，請稍後再試";B({text:v,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(y,t)=>{const f=J("VueFileAgent");return g(),V(w,null,[a(ue,{class:"custom-font"},{default:l(()=>[a(j,{style:{display:"flex","justify-content":"center"}},{default:l(()=>[a(u,{cols:"12"},{default:l(()=>[ie]),_:1}),a(I,{width:"500px",style:{"padding-left":"30px","padding-top":"15px"},class:"rounded-xl elevation-24"},{default:l(()=>[a(j,{class:"d-flex justify-center align-center"},{default:l(()=>[a(u,{cols:"12",class:"d-flex justify-center align-center"},{default:l(()=>[T("div",ce,[a(Q,{class:"avatar",src:o(s).avatar,style:{height:"150px",width:"150px",background:"cover"}},null,8,["src"])])]),_:1}),a(u,{cols:"12",style:{display:"flex","justify-content":"end"},class:"d-flex justify-center align-center"},{default:l(()=>[a(h,{onClick:E},{default:l(()=>[n("編輯個人資料")]),_:1})]),_:1})]),_:1}),a(j,{class:"d-flex justify-center align-center"},{default:l(()=>[a(u,{cols:"6"},{default:l(()=>[(g(),V(w,null,D(q,e=>a(k,{key:e.text},{default:l(()=>[a(le,{color:"pink-darken-3"},{default:l(()=>[n(x(e.icon),1)]),_:2},1024),n(" "+x(e.text),1)]),_:2},1024)),64))]),_:1}),a(u,{cols:"6"},{default:l(()=>[(g(!0),V(w,null,D(H.value,e=>(g(),V("span",{key:e.value},[a(k,null,{default:l(()=>[n(x(e.value),1)]),_:2},1024)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(K,{modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=e=>d.value=e),class:"custom-font"},{default:l(()=>[a(re,{disabled:o(b),onSubmit:W(o($),["prevent"])},{default:l(()=>[a(I,null,{default:l(()=>[a(Z,null,{default:l(()=>[n(x("編輯個人資料"))]),_:1}),a(k,null,{default:l(()=>[a(C,{label:"個人帳號：",modelValue:o(i).value.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o(i).value.value=e),"error-messages":o(i).errorMessage.value},null,8,["modelValue","error-messages"]),a(C,{label:"電子信箱：",modelValue:o(c).value.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o(c).value.value=e),"error-messages":o(c).errorMessage.value},null,8,["modelValue","error-messages"]),a(C,{label:"我的手機：",modelValue:o(m).value.value,"onUpdate:modelValue":t[2]||(t[2]=e=>o(m).value.value=e),"error-messages":o(m).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),a(f,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),"raw-model-value":U.value,"onUpdate:rawModelValue":t[4]||(t[4]=e=>U.value=e),accept:"image/jpg,image/png",deletable:"","error-text":{type:"檔案格式不支援",size:"檔案超過 1MB 大小限制"},"help-text":"選擇檔案或拖曳到這裡","max-files":1,"max-size":"1MB",ref_key:"fileAgent",ref:A},null,8,["modelValue","raw-model-value"]),a(ee,null,{default:l(()=>[a(ae),a(h,{color:"secondary",rounded:"",disabled:o(b),onClick:M},{default:l(()=>[n("取消")]),_:1},8,["disabled"]),a(h,{color:"primary",rounded:"",type:"submit",loading:o(b)},{default:l(()=>[n("送出")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}},Ve=L(me,[["__scopeId","data-v-3ad70bab"]]);export{Ve as default};
